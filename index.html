<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Calc</title>
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      display: flex;
      flex-direction: column;
      max-width: 450px;
      margin-left: auto;
      margin-right: auto;
      padding-top: 20px;
      padding-left: 20px;
      padding-right: 20px;
      font-family: sans-serif;
      background-color: black;
      color: darkgray;
      font-weight: bold;
    }

    input,
    button {
      font: inherit;
      background-color: inherit;
      border-radius: 7px;
      color: inherit;
      border: 1px solid springgreen;
      outline: none;
      text-align: center;
    }

    button {
      padding: 4rem 6rem;
      margin-top: 70px;
    }

    input:hover,
    input:focus {
      border-color: springgreen;
    }

    h2 {
      display: flex;
      align-items: center;
      gap: 10px;
      margin: 0 0 10px;
    }

    button,
    input,
    span {
      color: springgreen;
    }

    input::-webkit-outer-spin-button,
    input::-webkit-inner-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }

    .bar_outer {
      position: relative;
      width: 90%;
      height: 30px;
      background-color: #333;
      padding: 0 5px;
      display: flex;
      align-items: center;
    }

    .bar_inner {
      width: 0;
      height: 20px;
      background-color: springgreen;
      transition: 1s;
    }

    .bar_outer .m {
      position: absolute;
      top: 130%;
      width: 1px;
      text-align: center;
    }
    .bar_outer .m::before {
      content: '';
      position: absolute;
      bottom: 100%;
      left: 50%;
      width: 1px;
      height: 10px;
      background: #333;
    }

    .bar_outer .m0 {
      left: 0%;
    }

    .bar_outer .m25 {
      left: 25%;
    }

    .bar_outer .m50 {
      left: 50%;
    }

    .bar_outer .m75 {
      left: 75%;
    }

    .bar_outer .m100 {
      left: calc(100% - 1px);
    }
  </style>
</head>

<body>

    <h1>Калькулятор выдачи</h1>
    <p>Прошло: <span id="days-passed">71 д.</span></p>
    <label for="queue-input">Очередь:</label>
    <input type="number" id="queue-input" value="122" />
    <p>Выдано: <span id="issued">545</span></p>
    <label for="speed-input">Скорость:</label>
    <input type="number" id="speed-input" value="7.68" step="0.01" />
    <p>Ждать: <span id="days-wait">16 д.</span></p>
    <p>Выдача: <span id="issue-date">12 октября 2024</span></p>
    <p>Выполнено: <span id="completion">82%</span></p>

    <script>
        // Исходные данные
        const initialQueue = 667;
        const initialDate = new Date("2024-06-17");

        // Получаем элементы DOM
        const queueInput = document.getElementById("queue-input");
        const speedInput = document.getElementById("speed-input");
        const issuedElem = document.getElementById("issued");
        const daysWaitElem = document.getElementById("days-wait");
        const issueDateElem = document.getElementById("issue-date");
        const completionElem = document.getElementById("completion");

        // Начальные значения
        let issued = 545; // выдано
        let daysPassed = 71; // прошло дней

        // Функция для обновления значений
        function updateValues() {
            // Получаем текущее значение очереди и скорости
            const currentQueue = parseInt(queueInput.value);
            const currentSpeed = parseFloat(speedInput.value);

            // Обновляем количество выданных
            issued = issued + currentSpeed * daysPassed; // пересчет выданного
            issuedElem.textContent = Math.round(issued);

            // Обновляем процент выполнения
            const completion = ((issued / initialQueue) * 100).toFixed(2);
            completionElem.textContent = `${completion}%`;

            // Обновляем дни ожидания
            const remainingQueue = initialQueue - issued;
            const daysWait = Math.ceil(remainingQueue / currentSpeed);
            daysWaitElem.textContent = `${daysWait} д.`;

            // Обновляем дату выдачи
            const issueDate = new Date(initialDate);
            issueDate.setDate(initialDate.getDate() + daysWait);
            issueDateElem.textContent = issueDate.toLocaleDateString("ru-RU", {
                day: "numeric",
                month: "long",
                year: "numeric",
            });
        }

        // Обработчики событий для ввода
        queueInput.addEventListener("input", updateValues);
        speedInput.addEventListener("input", updateValues);

        // Первоначальный расчет
        updateValues();
    </script>

</body>

</html>
